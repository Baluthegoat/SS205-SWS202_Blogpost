---
import Pagination from '@/components/Pagination.astro'
import ProjectsList from '@/components/ProjectsList.astro'
import { sortProjects } from '@/helpers/util'
import PageLayout from '@/layouts/PageLayout.astro'
import config from '@/theme.config'
import type { GetStaticPaths, InferGetStaticPropsType } from 'astro'
import { getCollection } from 'astro:content'

export const getStaticPaths = (async ({ paginate }) => {
  const projects = (await getCollection('projects')).sort(sortProjects)

  return paginate(projects, { pageSize: config.projectsPerPage })
}) satisfies GetStaticPaths

type Props = InferGetStaticPropsType<typeof getStaticPaths>

const { page } = Astro.props

const frontmatter = {
  title: 'Projects',
  activeHeaderLink: 'Projects'
}
---

<PageLayout {frontmatter}>
  <h1>
    {frontmatter.title}
    <span>{` (page ${page.currentPage})`}</span>
  </h1>
  <ProjectsList projects={page.data} />

  <Pagination slot="bottom" page={page} />
</PageLayout>
